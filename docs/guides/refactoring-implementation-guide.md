# Руководство по внедрению рефакторинга

## Подготовка

- Создать ветку `refactor/solid`.
- Настроить CI на запуск `go test ./...` и smoke-сценариев.

## Шаги внедрения

1. Ввести DI/Providers
   - Создать `internal/di` и провайдеры клиентов.
   - Перевести `app/sonarqube_init.go` на DI.

2. Сегрегация интерфейсов
   - Ввести узкие интерфейсы и адаптировать сервисы.
   - Параллельная поддержка старых фасадов.

3. Логирование
   - Принять интерфейс логгера, добавить адаптер `SlogAdapter`.

4. SRP в `app`
   - Вынести инфраструктурные и доменные слои, оставить оркестрацию.

5. Реестр команд
   - Зарегистрировать обработчики, удалить `switch` после стабилизации.

## Проверка

- На каждом шаге: запуск юнит и интеграционных тестов, метрики покрытия.
- Smoke: запуск CLI на тестовом репозитории, проверка отчётов.

## Откат

- Флаги конфигурации для старых путей.
- Фасады для широких интерфейсов пока идёт миграция.