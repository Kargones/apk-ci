–†–∞–∑—Ä–∞–±–æ—Ç–∞–π –ø–æ–¥—Ä–æ–±–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –º–æ–¥—É–ª—è entity/filer –∫–æ—Ç–æ—Ä—ã–π —Ä–µ–∞–ª–∏–∑—É–µ—Ç —Å–ª–µ–¥—É—é—â–∏–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:
- —Ä–∞–±–æ—Ç—É —Å —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–æ–π, –ø—Ä–∏ —ç—Ç–æ–º —Ñ–∞–π–ª—ã –º–æ–≥—É—Ç —Ä–∞–∑–º–µ—â–∞—Ç—å—Å—è –∫–∞–∫ –Ω–∞ –¥–∏—Å–∫–µ —Ç–∞–∫ –∏ –≤ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ –≤ –ø–∞–º—è—Ç–∏.
- –ø—Ä–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –º–µ—Ç–æ–¥–æ–≤ —Ä–∞–±–æ—Ç—ã —Å —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–æ–π –≤ –ø–∞–º—è—Ç–∏ –∏—Å–ø–æ–ª—å–∑—É–π —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–Ω—ã–µ –≤ –∫–æ–Ω—Ü–µ —Ñ–∞–π–ª–∞ –º–∞—Ç–µ—Ä–∏–∞–ª **–í–∞—Ä–∏–∞–Ω—Ç—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ –≤–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã**
- –º–æ–¥—É–ª—å –¥–æ–ª–∂–µ–Ω —Ä–µ–∞–ª–∏–∑–æ–≤—ã–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ —Ñ–∞–π–ª–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏:
- MkdirTemp
- MkdirAll
- RemoveAll
- Create
- Stat
- IsNotExist
- Remove
- CreateTemp
- WriteFile
- ReadDir
- Rename
- Open
- Getwd
- Chdir
- ReadFile
- WriteFile
- OpenFile
- Chmod
- Chown
- –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ –º–æ–¥—É–ª—è –º–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –ø—É—Ç—å –∫ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ –Ω–∞ –¥–∏—Å–∫–µ.
- –µ—Å–ª–∏ –ø—É—Ç—å –∫ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ –Ω–∞ –¥–∏—Å–∫–µ –Ω–µ —É–∫–∞–∑–∞–Ω, —Ç–æ —Ñ–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω–∞ –∫–∞—Ç–∞–ª–æ–≥–µ os.TempDir() + filer.DefaultDir.
- –µ—Å–ª–∏ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –ø–∞—Ä–∞–º–µ—Ç—Ä MemoryFS, —Ç–æ —Ñ–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω–∞ –≤ –ø–∞–º—è—Ç–∏.
- –µ—Å–ª–∏ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –ø–∞—Ä–∞–º–µ—Ç—Ä DiskFS, —Ç–æ —Ñ–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω–∞ –Ω–∞ –¥–∏—Å–∫–µ.

–ù–µ –ø—Ä–∏—Å—Ç—É–ø–∞–π –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –º–æ–¥—É–ª—è, —Ç–æ–ª—å–∫–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É.
–ó–∞–ø–∏—à–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –≤ —Ñ–∞–π–ª entity/filer/arch.md.

**–í–∞—Ä–∏–∞–Ω—Ç—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ –≤–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã**
```go
import (
    "runtime"
    "os"
    "path/filepath"
)

func GetTempDir() string {
    if runtime.GOOS == "linux" {
        // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å /dev/shm (RAM-–¥–∏—Å–∫ –≤ Linux)
        if _, err := os.Stat("/dev/shm"); err == nil {
            return "/dev/shm/myapp"
        }
    }
    return os.TempDir()
}
```
### 1. **–°–æ–∑–¥–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º**
```go
func GetTempDir() (string, error) {
    var tempDir string
    
    if runtime.GOOS == "linux" {
        if _, err := os.Stat("/dev/shm"); err == nil {
            tempDir = "/dev/shm/myapp"
        }
    }
    
    if tempDir == "" {
        tempDir = filepath.Join(os.TempDir(), "myapp")
    }
    
    // –í–ê–ñ–ù–û: —Å–æ–∑–¥–∞—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é, –µ—Å–ª–∏ –µ—ë –Ω–µ—Ç
    if err := os.MkdirAll(tempDir, 0755); err != nil {
        return "", fmt.Errorf("failed to create temp dir: %w", err)
    }
    
    return tempDir, nil
}
```

### 2. **–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å –≤–Ω–µ—à–Ω–∏–º–∏ –ø—Ä–æ–≥—Ä–∞–º–º–∞–º–∏**
```go
import (
    "os/exec"
    "path/filepath"
)

func RunExternalCommand() error {
    tempDir, err := GetTempDir()
    if err != nil {
        return err
    }
    
    // –°–æ–∑–¥–∞—ë–º —É–Ω–∏–∫–∞–ª—å–Ω—É—é –ø–æ–¥–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–∏
    workDir := filepath.Join(tempDir, fmt.Sprintf("work_%d", time.Now().UnixNano()))
    if err := os.MkdirAll(workDir, 0755); err != nil {
        return err
    }
    defer os.RemoveAll(workDir) // –û—á–∏—Å—Ç–∫–∞ –ø–æ—Å–ª–µ —Ä–∞–±–æ—Ç—ã
    
    // –ö–ª–æ–Ω–∏—Ä—É–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
    cmd := exec.Command("git", "clone", "--depth=1", "https://github.com/repo.git", workDir)
    if err := cmd.Run(); err != nil {
        return err
    }
    
    // –ó–∞–ø—É—Å–∫–∞–µ–º –≤–Ω–µ—à–Ω—é—é –ø—Ä–æ–≥—Ä–∞–º–º—É —Å —ç—Ç–∏–º –ø—É—Ç—ë–º
    cmd = exec.Command("external-tool", "--input", workDir, "--output", filepath.Join(workDir, "result"))
    cmd.Dir = workDir // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–∞–±–æ—á—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
    
    return cmd.Run()
}
```

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è /dev/shm:

### 1. **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–æ —Ä–∞–∑–º–µ—Ä—É**
```go
import "github.com/shirou/gopsutil/v3/mem"

func CheckAvailableRAM() (uint64, error) {
    v, err := mem.VirtualMemory()
    if err != nil {
        return 0, err
    }
    
    // /dev/shm –æ–±—ã—á–Ω–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω 50% –æ—Ç RAM
    shmMax := v.Total / 2
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä
    var stat syscall.Statfs_t
    if err := syscall.Statfs("/dev/shm", &stat); err == nil {
        available := stat.Bavail * uint64(stat.Bsize)
        return available, nil
    }
    
    return shmMax, nil
}
```

### 2. **Fallback –º–µ—Ö–∞–Ω–∏–∑–º –ø—Ä–∏ –Ω–µ—Ö–≤–∞—Ç–∫–µ –º–µ—Å—Ç–∞**
```go
type TempDirManager struct {
    preferRAM bool
    fallbackDir string
}

func (m *TempDirManager) GetWorkDir(estimatedSize int64) (string, error) {
    if m.preferRAM && runtime.GOOS == "linux" {
        available, _ := CheckAvailableRAM()
        
        // –ï—Å–ª–∏ –º–µ—Å—Ç–∞ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ (—Å –∑–∞–ø–∞—Å–æ–º 20%)
        if available > uint64(estimatedSize)*120/100 {
            return "/dev/shm/myapp", nil
        }
    }
    
    // Fallback –Ω–∞ –æ–±—ã—á–Ω—ã–π –¥–∏—Å–∫
    return filepath.Join(os.TempDir(), "myapp"), nil
}
```

## üîß –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –≤–Ω–µ—à–Ω–∏–º–∏ –ø—Ä–æ–≥—Ä–∞–º–º–∞–º–∏:

### 1. **–ò–∑–æ–ª—è—Ü–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤**
```go
func RunIsolated(workDir string, command string, args ...string) error {
    // –°–æ–∑–¥–∞—ë–º —É–Ω–∏–∫–∞–ª—å–Ω—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞
    processDir := filepath.Join(workDir, fmt.Sprintf("proc_%d_%d", 
        os.Getpid(), time.Now().UnixNano()))
    
    if err := os.MkdirAll(processDir, 0755); err != nil {
        return err
    }
    defer os.RemoveAll(processDir)
    
    cmd := exec.Command(command, args...)
    cmd.Dir = processDir
    
    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
    cmd.Env = append(os.Environ(),
        fmt.Sprintf("TMPDIR=%s", processDir),
        fmt.Sprintf("TEMP=%s", processDir),
        fmt.Sprintf("TMP=%s", processDir),
    )
    
    return cmd.Run()
}
```

