### Общие требования:
Проект должен отвечать следующим требованиям:

#### Организация кода:
- Использовать короткие, описательные имена для пакетов (cfg, auth, db)
- Группировать импорты: стандартная библиотека, внешние пакеты, внутренние пакеты
- Максимальный размер файла - до 500 строк
- Все экспортируемые элементы должны иметь godoc комментарии

#### Структуры:
- Все структуры, используемые более чем в одном пакете Go, должны быть перенесены в файл `internal/structures/types.go`
- Структуры, используемые только в тестах, также подлежат выносу при использовании в нескольких пакетах
- Поля в структурах должны быть упорядочены для оптимального memory alignment
- Указатели в полях структур использовать только при необходимости мутации
- Использовать указатели для опциональных полей, которые могут отсутствовать
- Всегда инициализировать обязательные поля значениями по умолчанию
- Четко разделять опциональные и обязательные поля в структурах
- Все структуры должны иметь методы Validate() для валидации при создании
- Все структуры должны иметь методы Clone() для глубокого копирования (только при явном требовании)
- Структуры не должны быть thread-safe (ответственность вызывающего кода)
- Структуры должны быть мутабельными для удобства использования
- При выносе структур сохранять обратную совместимость не требуется

#### Константы:
- Все константы, используемые более чем в одном пакете Go, должны быть перенесены в директорию `internal/constants/`
- Константы должны группироваться по назначению в отдельные файлы:
  - `errors.go` - кастомные типы ошибок для всех групп связанных констант
  - `defaults.go` - значения по умолчанию
  - `endpoints.go` - URL и эндпоинты
- Константы должны объявляться в блоках `const`
- Для перечислений необходимо использовать `iota`
- Именование констант должно следовать соглашению `UPPER_SNAKE_CASE`
- Связанные константы должны иметь общие префиксы для группировки
- Каждая константа должна иметь godoc комментарий с описанием

#### Обработка ошибок:
- Возвращать ошибки вызывающему коду без логирования в общих компонентах
- Всегда оборачивать ошибки с контекстом: fmt.Errorf("context: %w", err)
- Использовать кастомные типы ошибок с подробными сообщениями
- Включать отладочную информацию для автоматического анализа ошибок с помощью LLM через контекст ошибок (не прямое логирование)

#### Производительность:
- Не оптимизировать преждевременно (избегать sync.Pool)
- Использовать обычную конкатенацию строк через +
- Глубокое копирование структур только при явном требовании

#### Процесс рефакторинга:
1. Сначала выносить общие структуры в `internal/structures/types.go`
2. Затем выносить константы в соответствующие файлы в `internal/constants/`
3. Использовать интерфейсы для dependency injection и избежания циклических зависимостей
4. Создавать интерфейсы только для структур с методами и только для целей тестирования
5. Не создавать интерфейсы для простых структур данных без методов
6. Deprecated элементы помечать аннотацией `// @Deprecated`
7. Создавать unit тесты в одном общем файле `internal/structures/types_test.go` с фиксированными тестовыми данными (минимум 80% покрытия)
8. Использовать property-based тестирование через testify/quick для валидации структур
9. Обновлять godoc документацию после завершения рефакторинга
10. Проверять код через golangci-lint с полным набором правил

#### Совместимость и миграция:
- Допускаются breaking changes с миграцией (версионирование не требуется)
- Добавлять новые поля в конец структуры для совместимости
- Использовать yaml теги, json теги по необходимости для сериализации
- Ручная миграция данных с валидацией при изменении структур
