# Epic 0: Extension Publish

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à—ë–Ω (Legacy-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** ‚òÖ –ó–ê–í–ï–†–®–Å–ù
**–†–∏—Å–∫:** üü¢ –ù–∏–∑–∫–∏–π (—Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω)
**Stories:** 8/8 (100%)
**FRs:** NEW (–≤–Ω–µ –æ—Å–Ω–æ–≤–Ω–æ–π –Ω—É–º–µ—Ä–∞—Ü–∏–∏ FR1-68)
**–î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:** 2025-12-08
**–ê—É–¥–∏—Ç:** 2026-01-26

---

## üìä Gap Analysis (–ê—É–¥–∏—Ç 2026-01-26)

### –°—Ç–∞—Ç—É—Å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: ‚úÖ –ó–ê–í–ï–†–®–Å–ù

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –ü–ª–∞–Ω | –†–µ–∞–ª–∏–∑–∞—Ü–∏—è | –°—Ç–∞—Ç—É—Å |
|-----------|------|------------|--------|
| GetLatestRelease() | Story 0.1 | `internal/entity/gitea/gitea.go` | ‚úÖ |
| SearchAllRepos() | Story 0.2 | `internal/entity/gitea/gitea.go` | ‚úÖ |
| GetProjectSubscriptions() | Story 0.3 | `internal/app/extension_publish.go:39` | ‚úÖ |
| SyncExtensionDirectory() | Story 0.4 | `internal/app/extension_publish.go` | ‚úÖ |
| CreatePR with release info | Story 0.5 | `internal/entity/gitea/gitea.go` | ‚úÖ |
| –ö–æ–º–∞–Ω–¥–∞ extension-publish | Story 0.6 | `cmd/benadis-runner/main.go:244` | ‚úÖ |
| Error handling & reporting | Story 0.7 | `internal/app/extension_publish.go` | ‚úÖ |
| Unit & Integration —Ç–µ—Å—Ç—ã | Story 0.8 | `extension_publish_test.go` (92.9%) | ‚úÖ |

### ‚ö†Ô∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π GAP

**–ü—Ä–æ–±–ª–µ–º–∞:** –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ **legacy-—Å—Ç–∏–ª–µ** (switch-case –≤ main.go), –∞ –Ω–µ —á–µ—Ä–µ–∑ Command Registry.

```go
// –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è (legacy):
case constants.ActExtensionPublish:
    err = app.ExtensionPublish(&ctx, l, cfg)

// –û–∂–∏–¥–∞–µ–º–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (Epic 1):
handler := command.Get("extension-publish")
err = handler.Execute(ctx, cfg)
```

### TODO –¥–ª—è –ø–æ–ª–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏

- [ ] –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ Command Registry –ø–æ—Å–ª–µ Epic 1
- [ ] –î–æ–±–∞–≤–∏—Ç—å –∫–∞–∫ Story 1.10 –≤ Epic 1
- [ ] –ü–æ–º–µ—Ç–∏—Ç—å legacy case –∫–∞–∫ @deprecated

### –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ | –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ |
|---------|----------|------------|
| Test Coverage | 92.9% | 80% ‚úÖ |
| Code Review Issues | 0 open | 0 ‚úÖ |
| –†–µ—Ç—Ä–æ—Å–ø–µ–∫—Ç–∏–≤–∞ | –ü—Ä–æ–≤–µ–¥–µ–Ω–∞ | ‚úÖ |

---

## –¶–µ–ª—å

–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∫–æ–º–∞–Ω–¥—É `extension-publish`, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Ä–µ–ª–∏–∑–∞ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é –≤–æ –≤—Å–µ "–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–µ" —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ —á–µ—Ä–µ–∑ –º–µ—Ö–∞–Ω–∏–∑–º –≤–µ—Ç–æ–∫-–ø–æ–¥–ø–∏—Å–æ–∫.

## –¶–µ–Ω–Ω–æ—Å—Ç—å

–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π 1C –º–µ–∂–¥—É —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è–º–∏ –±–µ–∑ —Ä—É—á–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è.

## –ë–∏–∑–Ω–µ—Å-–∫–æ–Ω—Ç–µ–∫—Å—Ç

- –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è —è–≤–ª—è–µ—Ç—Å—è –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º –∏—Å—Ç–∏–Ω—ã
- –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Ä–µ–ª–∏–∑–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –≤—Å–µ "–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–µ" —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
- –ü–æ–¥–ø–∏—Å–∫–∞ –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ —Ñ–∞–π–ª `project.yaml` –≤ –∫–æ—Ä–Ω–µ —Ü–µ–ª–µ–≤–æ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è, —Å–µ–∫—Ü–∏—è `subscriptions`
- –§–æ—Ä–º–∞—Ç –ø–æ–¥–ø–∏—Å–∫–∏: `{Org}_{Repo}_{ExtDir}` (–Ω–∞–ø—Ä–∏–º–µ—Ä: `lib_ssl_–∞–ø–∫–ë–°–ü`)

## –¢—Ä–∏–≥–≥–µ—Ä –∑–∞–ø—É—Å–∫–∞

- **Event:** `on: release` (Gitea Actions)
- **–†–µ–∂–∏–º:** –¢–æ–ª—å–∫–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π

---

## Stories

### Story 0.1: –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ Gitea API –¥–ª—è —Ä–µ–ª–∏–∑–æ–≤

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** P0 | **–†–∞–∑–º–µ—Ä:** S | **–†–∏—Å–∫:** Low

**As a** —Å–∏—Å—Ç–µ–º–∞,
**I want** –ø–æ–ª—É—á–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ä–µ–ª–∏–∑–∞—Ö —á–µ—Ä–µ–∑ Gitea API,
**So that** —è –º–æ–≥—É –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –≤–µ—Ä—Å–∏—é –¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏.

**Acceptance Criteria:**

- [ ] –ú–µ—Ç–æ–¥ `GetLatestRelease()` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ä–µ–ª–∏–∑
- [ ] –ú–µ—Ç–æ–¥ `GetReleaseByTag()` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–ª–∏–∑ –ø–æ —Ç–µ–≥—É
- [ ] –°—Ç—Ä—É–∫—Ç—É—Ä–∞ `Release` —Å–æ–¥–µ—Ä–∂–∏—Ç: tag_name, name, body, assets

**Technical Notes:**
- –§–∞–π–ª: `internal/entity/gitea/gitea.go`
- Gitea API: `GET /repos/{owner}/{repo}/releases/latest`

---

### Story 0.2: –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ Gitea API –¥–ª—è –ø–æ–∏—Å–∫–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** P0 | **–†–∞–∑–º–µ—Ä:** S | **–†–∏—Å–∫:** Low

**As a** —Å–∏—Å—Ç–µ–º–∞,
**I want** –∏—Å–∫–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –ø–æ –≤—Å–µ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏,
**So that** —è –º–æ–≥—É –Ω–∞–π—Ç–∏ –≤—Å–µ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –ø–æ–¥–ø–∏—Å—á–∏–∫–∏.

**Acceptance Criteria:**

- [ ] –ú–µ—Ç–æ–¥ `SearchAllRepos()` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤—Å–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π
- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
- [ ] –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ (limit/page)

**Technical Notes:**
- –§–∞–π–ª: `internal/entity/gitea/gitea.go`
- Gitea API: `GET /repos/search`

---

### Story 0.3: –ü–æ–∏—Å–∫ –ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** P0 | **–†–∞–∑–º–µ—Ä:** M | **–†–∏—Å–∫:** Medium

**As a** —Å–∏—Å—Ç–µ–º–∞,
**I want** –Ω–∞–π—Ç–∏ –≤—Å–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏, –ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–µ –Ω–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ,
**So that** —è –∑–Ω–∞—é –∫—É–¥–∞ –ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ.

**Acceptance Criteria:**

- [ ] –ß—Ç–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ `project.yaml` –∏–∑ –∫–æ—Ä–Ω—è –∫–∞–∂–¥–æ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
- [ ] –ü–∞—Ä—Å–∏–Ω–≥ —Å–µ–∫—Ü–∏–∏ `subscriptions` (–º–∞—Å—Å–∏–≤ —Å—Ç—Ä–æ–∫)
- [ ] –§–æ—Ä–º–∞—Ç –ø–æ–¥–ø–∏—Å–∫–∏: `{Org}_{Repo}_{ExtDir}` (–Ω–∞–ø—Ä–∏–º–µ—Ä: `lib_ssl_–∞–ø–∫–ë–°–ü`)
- [ ] –ï—Å–ª–∏ `project.yaml` –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç ‚Äî —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–µ –ø–æ–¥–ø–∏—Å–∞–Ω
- [ ] –ï—Å–ª–∏ —Å–µ–∫—Ü–∏—è `subscriptions` –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∏–ª–∏ –ø—É—Å—Ç–∞ ‚Äî —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–µ –ø–æ–¥–ø–∏—Å–∞–Ω
- [ ] –í–æ–∑–≤—Ä–∞—Ç —Å–ø–∏—Å–∫–∞: repo + target branch + target directory

**Technical Notes:**
- –§–∞–π–ª: `internal/app/extension_publish.go`
- –ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è: `GetProjectSubscriptions(api, branch) ([]string, error)`
- –£–¥–∞–ª–∏—Ç—å: `ParseSubscriptionBranch()`, `IsSubscriptionBranch()`, `excludedBranches`
- –ü—Ä–∏–º–µ—Ä `project.yaml`:
  ```yaml
  subscriptions:
    - lib_ssl_–∞–ø–∫–ë–°–ü
    - lib_common_cfe_utils
  ```

---

### Story 0.4: –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∫–∞—Ç–∞–ª–æ–≥–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** P0 | **–†–∞–∑–º–µ—Ä:** M | **–†–∏—Å–∫:** Medium

**As a** —Å–∏—Å—Ç–µ–º–∞,
**I want** —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª—ã —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –≤ —Ü–µ–ª–µ–≤–æ–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π,
**So that** –ø–æ–¥–ø–∏—Å—á–∏–∫ –ø–æ–ª—É—á–∞–µ—Ç –∞–∫—Ç—É–∞–ª—å–Ω—É—é –≤–µ—Ä—Å–∏—é.

**Acceptance Criteria:**

- [ ] –ü–æ–ª–Ω–∞—è –∑–∞–º–µ–Ω–∞ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ —Ü–µ–ª–µ–≤–æ–≥–æ –∫–∞—Ç–∞–ª–æ–≥–∞
- [ ] Commit message —Å–æ–¥–µ—Ä–∂–∏—Ç –≤–µ—Ä—Å–∏—é –∏ –∏—Å—Ç–æ—á–Ω–∏–∫
- [ ] –§–æ—Ä–º–∞—Ç: `chore(ext): update {extName} to {version}`

**Technical Notes:**
- –§–∞–π–ª: `internal/app/extension_publish.go`
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `SetRepositoryState()` –¥–ª—è batch-–æ–ø–µ—Ä–∞—Ü–∏–π

---

### Story 0.5: –°–æ–∑–¥–∞–Ω–∏–µ PR —Å –ø–æ–ª–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** P0 | **–†–∞–∑–º–µ—Ä:** S | **–†–∏—Å–∫:** Low

**As a** —Å–∏—Å—Ç–µ–º–∞,
**I want** —Å–æ–∑–¥–∞–≤–∞—Ç—å PR —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —Ä–µ–ª–∏–∑–µ,
**So that** maintainer –ø–æ–Ω–∏–º–∞–µ—Ç —á—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å.

**Acceptance Criteria:**

- [ ] Title: `Update {extName} to {version}`
- [ ] Body —Å–æ–¥–µ—Ä–∂–∏—Ç: –≤–µ—Ä—Å–∏—é, release notes, —Å—Å—ã–ª–∫—É –Ω–∞ —Ä–µ–ª–∏–∑
- [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π assignee (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω)

**Technical Notes:**
- –§–∞–π–ª: `internal/entity/gitea/gitea.go`
- –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ `CreatePR()`

---

### Story 0.6: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∫–æ–º–∞–Ω–¥—ã extension-publish

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** P0 | **–†–∞–∑–º–µ—Ä:** S | **–†–∏—Å–∫:** Low

**As a** DevOps-–∏–Ω–∂–µ–Ω–µ—Ä,
**I want** –∑–∞–ø—É—Å–∫–∞—Ç—å –∫–æ–º–∞–Ω–¥—É —á–µ—Ä–µ–∑ BR_COMMAND,
**So that** –ø—É–±–ª–∏–∫–∞—Ü–∏—è –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–∞ –≤ CI/CD.

**Acceptance Criteria:**

- [ ] –ö–æ–Ω—Å—Ç–∞–Ω—Ç–∞ `CmdExtensionPublish` –≤ constants.go
- [ ] –§—É–Ω–∫—Ü–∏—è `ExtensionPublish()` –≤ app/
- [ ] Case –≤ main.go switch

**Technical Notes:**
- –§–∞–π–ª—ã: `internal/constants/constants.go`, `cmd/benadis-runner/main.go`

---

### Story 0.7: –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ –æ—Ç—á—ë—Ç–Ω–æ—Å—Ç—å

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** P0 | **–†–∞–∑–º–µ—Ä:** M | **–†–∏—Å–∫:** Medium

**As a** DevOps-–∏–Ω–∂–µ–Ω–µ—Ä,
**I want** –ø–æ–ª—É—á–∞—Ç—å –¥–µ—Ç–∞–ª—å–Ω—ã–π –æ—Ç—á—ë—Ç –æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö –ø—É–±–ª–∏–∫–∞—Ü–∏–∏,
**So that** —è –∑–Ω–∞—é —á—Ç–æ —É–¥–∞–ª–æ—Å—å –∏ —á—Ç–æ –Ω–µ—Ç.

**Acceptance Criteria:**

- [ ] Continue on error ‚Äî –æ–¥–Ω–∞ –æ—à–∏–±–∫–∞ –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –æ—Å—Ç–∞–ª—å–Ω—ã–µ
- [ ] –ò—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á—ë—Ç: —É—Å–ø–µ—à–Ω—ã–µ / –Ω–µ—É—Å–ø–µ—à–Ω—ã–µ / –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ
- [ ] Exit code = 1 –µ—Å–ª–∏ —Ö–æ—Ç—è –±—ã –æ–¥–Ω–∞ –æ—à–∏–±–∫–∞

**Technical Notes:**
- –ü–∞—Ç—Ç–µ—Ä–Ω: collect errors, report at end
- JSON output –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

---

### Story 0.8: Unit –∏ Integration —Ç–µ—Å—Ç—ã

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** P1 | **–†–∞–∑–º–µ—Ä:** M | **–†–∏—Å–∫:** Low

**As a** —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫,
**I want** –∏–º–µ—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è –ª–æ–≥–∏–∫–∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏,
**So that** —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

**Acceptance Criteria:**

- [ ] –ü–æ–∫—Ä—ã—Ç–∏–µ >80% –¥–ª—è extension_publish.go
- [ ] Mock Gitea API –¥–ª—è unit-—Ç–µ—Å—Ç–æ–≤
- [ ] Integration test —Å —Ä–µ–∞–ª—å–Ω—ã–º Gitea (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

**Technical Notes:**
- –§–∞–π–ª: `internal/app/extension_publish_test.go`
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å httptest –¥–ª—è mock

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

| –§–∞–π–ª | –°–æ–¥–µ—Ä–∂–∏–º–æ–µ |
|------|------------|
| `internal/constants/constants.go` | –ö–æ–Ω—Å—Ç–∞–Ω—Ç–∞ `CmdExtensionPublish` |
| `internal/entity/gitea/gitea.go` | –ù–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã API |
| `internal/entity/gitea/types.go` | –°—Ç—Ä—É–∫—Ç—É—Ä–∞ `Release`, —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ `Repository`, —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ `ProjectYAML` |
| `internal/app/extension_publish.go` | –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –∫–æ–º–∞–Ω–¥—ã |
| `cmd/benadis-runner/main.go` | –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ (case –≤ switch) |

### –ú–µ—Ö–∞–Ω–∏–∑–º –ø–æ–¥–ø–∏—Å–æ–∫

**–ü–æ–¥—Ö–æ–¥:** –î–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–æ–¥–ø–∏—Å–∫–∞ —á–µ—Ä–µ–∑ `project.yaml` –≤ —Ü–µ–ª–µ–≤–æ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏.

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```yaml
# project.yaml –≤ –∫–æ—Ä–Ω–µ —Ü–µ–ª–µ–≤–æ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
subscriptions:
  - lib_ssl_–∞–ø–∫–ë–°–ü        # {Org}_{Repo}_{ExtDir}
  - lib_common_cfe_utils
```

**–ê–ª–≥–æ—Ä–∏—Ç–º –ø–æ–∏—Å–∫–∞ –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤:**
1. –°–∫–∞–Ω–∏—Ä—É–µ–º –≤—Å–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
2. –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è —á–∏—Ç–∞–µ–º `project.yaml` (–≤–µ—Ç–∫–∞ main)
3. –ü–∞—Ä—Å–∏–º —Å–µ–∫—Ü–∏—é `subscriptions`
4. –ï—Å–ª–∏ `{sourceOrg}_{sourceRepo}_{extDir}` –Ω–∞–π–¥–µ–Ω –≤ —Å–ø–∏—Å–∫–µ ‚Üí —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –ø–æ–¥–ø–∏—Å–∞–Ω

**–£–¥–∞–ª—è–µ–º—ã–π –∫–æ–¥ (—É—Å—Ç–∞—Ä–µ–≤—à–∏–π –º–µ—Ö–∞–Ω–∏–∑–º –≤–µ—Ç–æ–∫-–ø–æ–¥–ø–∏—Å–æ–∫):**
- `ParseSubscriptionBranch()`
- `IsSubscriptionBranch()`
- `excludedBranches`

## –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∫–æ–¥–∞

- `Config.AnalyzeProject()` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ –∏–º–µ–Ω–∏ –ø—Ä–æ–µ–∫—Ç–∞ –∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
- `GetFileContent()` ‚Äî —á—Ç–µ–Ω–∏–µ `project.yaml` –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
- `SetRepositoryState()` ‚Äî batch-–æ–ø–µ—Ä–∞—Ü–∏–∏ —Å —Ñ–∞–π–ª–∞–º–∏
- `CreatePR()` ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ Pull Request

### –í–Ω–µ—à–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

- Gitea API v1
- Gitea Actions runtime

---

## Risk Assessment

| –†–∏—Å–∫ | –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å | –ò–º–ø–∞–∫—Ç | –ú–∏—Ç–∏–≥–∞—Ü–∏—è |
|------|-------------|--------|-----------|
| –ú–∞—Å—Å–æ–≤–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤ | –°—Ä–µ–¥–Ω—è—è | –í—ã—Å–æ–∫–∏–π | Dry-run —Ä–µ–∂–∏–º, –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ |
| API rate limits Gitea | –ù–∏–∑–∫–∞—è | –°—Ä–µ–¥–Ω–∏–π | –ü–∞–≥–∏–Ω–∞—Ü–∏—è, –∑–∞–¥–µ—Ä–∂–∫–∏ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏ |
| –û—à–∏–±–∫–∞ –≤ –æ–¥–Ω–æ–º —Ä–µ–ø–æ –±–ª–æ–∫–∏—Ä—É–µ—Ç –æ—Å—Ç–∞–ª—å–Ω—ã–µ | –°—Ä–µ–¥–Ω—è—è | –í—ã—Å–æ–∫–∏–π | Continue on error, –æ—Ç—á—ë—Ç –≤ –∫–æ–Ω—Ü–µ |

---

## Definition of Done

- [ ] –í—Å–µ Acceptance Criteria –≤—ã–ø–æ–ª–Ω–µ–Ω—ã
- [ ] Code review –ø—Ä–æ–π–¥–µ–Ω
- [ ] Unit-—Ç–µ—Å—Ç—ã –Ω–∞–ø–∏—Å–∞–Ω—ã –∏ –ø—Ä–æ—Ö–æ–¥—è—Ç (>80% coverage)
- [ ] –ö–æ–º–∞–Ω–¥–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ Gitea Actions workflow
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–º –æ–∫—Ä—É–∂–µ–Ω–∏–∏
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞

---

## –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

- [Epic Overview](./index.md)
- [–î–µ—Ç–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](../../docs/epics/extension-publish.md)

---

_–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: 2026-01-26_
_–ê—É–¥–∏—Ç –ø—Ä–æ–≤–µ–¥—ë–Ω: 2026-01-26 (BMAD Party Mode)_
